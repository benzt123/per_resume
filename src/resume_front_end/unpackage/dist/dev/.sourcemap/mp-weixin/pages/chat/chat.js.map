{"version":3,"file":"chat.js","sources":["pages/chat/chat.vue","../Edgedownload/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2hhdC9jaGF0LnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<!-- èŠå¤©è®°å½•åŒºåŸŸ -->\n\t\t<scroll-view \n\t\t\tclass=\"chat-container\" \n\t\t\tscroll-y=\"true\" \n\t\t\t:scroll-top=\"scrollTop\"\n\t\t\tscroll-with-animation=\"true\">\n\t\t\t\n\t\t\t<!-- æ¬¢è¿æ¶ˆæ¯ -->\n\t\t\t<view class=\"message-item assistant-message\" v-if=\"messages.length === 0\">\n\t\t\t\t<view class=\"avatar assistant-avatar\">ğŸ¤–</view>\n\t\t\t\t<view class=\"message-content\">\n\t\t\t\t\t<text class=\"message-text\">ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„æ™ºèƒ½è®°è´¦åŠ©æ‰‹ã€‚ä½ å¯ä»¥ï¼š</text>\n\t\t\t\t\t<text class=\"message-text\">ğŸ’° è¯´\"çº¢ç‰›20å…ƒ\"æ¥å¿«é€Ÿè®°è´¦</text>\n\t\t\t\t\t<text class=\"message-text\">ğŸ“Š è¯¢é—®ç†è´¢å»ºè®®å’Œè´¦ç›®åˆ†æ</text>\n\t\t\t\t\t<text class=\"message-text\">ğŸ’¡ å’¨è¯¢ä»»ä½•è´¢åŠ¡ç›¸å…³é—®é¢˜</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- èŠå¤©æ¶ˆæ¯åˆ—è¡¨ -->\n\t\t\t<view v-for=\"(message, index) in messages\" :key=\"index\" \n\t\t\t\tclass=\"message-item\" \n\t\t\t\t:class=\"message.role === 'user' ? 'user-message' : 'assistant-message'\">\n\t\t\t\t\n\t\t\t\t<!-- AIæ¶ˆæ¯ï¼šå¤´åƒåœ¨å·¦è¾¹ -->\n\t\t\t\t<template v-if=\"message.role === 'assistant'\">\n\t\t\t\t\t<view class=\"avatar assistant-avatar\">ğŸ¤–</view>\n\t\t\t\t\t<view class=\"message-content\">\n\t\t\t\t\t\t<text class=\"message-text\">{{ message.content }}</text>\n\t\t\t\t\t\t<text class=\"message-time\">{{ formatTime(message.timestamp) }}</text>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<!-- è®°è´¦ä¿¡æ¯æ¯ç¬”å•ç‹¬æ˜¾ç¤ºç¡®è®¤æŒ‰é’® -->\n\t\t\t\t\t\t<view v-if=\"message.recordsData && message.recordsData.length > 0\" class=\"records-action\">\n\t\t\t\t\t\t\t<!-- æ¯ç¬”è®°å½•å•ç‹¬æ˜¾ç¤º -->\n\t\t\t\t\t\t\t<view v-for=\"(record, recordIndex) in message.recordsData\" :key=\"recordIndex\" class=\"single-record-confirm\">\n\t\t\t\t\t\t\t\t<view class=\"record-card\">\n\t\t\t\t\t\t\t\t\t<view class=\"record-header\">\n\t\t\t\t\t\t\t\t\t\t<text class=\"record-type-icon\">{{ record.type === 'expense' ? 'ğŸ’¸' : 'ğŸ’°' }}</text>\n\t\t\t\t\t\t\t\t\t\t<text class=\"record-type-text\">{{ record.type === 'expense' ? 'æ”¯å‡º' : 'æ”¶å…¥' }}</text>\n\t\t\t\t\t\t\t\t\t\t<text class=\"record-amount\">Â¥{{ record.amount }}</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t<view class=\"record-details\">\n\t\t\t\t\t\t\t\t\t\t<text class=\"record-category\">åˆ†ç±»: {{ record.category }}</text>\n\t\t\t\t\t\t\t\t\t\t<text class=\"record-time\" v-if=\"record.time\">æ—¶é—´: {{ record.time }}</text>\n\t\t\t\t\t\t\t\t\t\t<text class=\"record-note\" v-if=\"record.note\">å¤‡æ³¨: {{ record.note }}</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<!-- æ¯ç¬”è®°å½•çš„ç‹¬ç«‹ç¡®è®¤æŒ‰é’® -->\n\t\t\t\t\t\t\t\t\t<button \n\t\t\t\t\t\t\t\t\t\tclass=\"confirm-single-btn\" \n\t\t\t\t\t\t\t\t\t\t@click=\"confirmSingleRecord(record, recordIndex, message)\"\n\t\t\t\t\t\t\t\t\t\tv-if=\"!record.recorded\">\n\t\t\t\t\t\t\t\t\t\tâœ… ç¡®è®¤æ­¤ç¬”è®°è´¦\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<view class=\"recorded-single-status\" v-else>\n\t\t\t\t\t\t\t\t\t\t<text class=\"recorded-text\">âœ… å·²è®°å½•</text>\n\t\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</template>\n\t\t\t\t\n\t\t\t\t<!-- ç”¨æˆ·æ¶ˆæ¯ï¼šå¤´åƒåœ¨å³è¾¹ -->\n\t\t\t\t<template v-else>\n\t\t\t\t\t<view class=\"message-content\">\n\t\t\t\t\t\t<text class=\"message-text\">{{ message.content }}</text>\n\t\t\t\t\t\t<text class=\"message-time\">{{ formatTime(message.timestamp) }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"avatar user-avatar\">ğŸ‘¤</view>\n\t\t\t\t</template>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- åŠ è½½çŠ¶æ€ -->\n\t\t\t<view v-if=\"isLoading\" class=\"message-item assistant-message\">\n\t\t\t\t<view class=\"avatar assistant-avatar\">ğŸ¤–</view>\n\t\t\t\t<view class=\"message-content loading-content\">\n\t\t\t\t\t<view class=\"loading-dots\">\n\t\t\t\t\t\t<view class=\"dot\"></view>\n\t\t\t\t\t\t<view class=\"dot\"></view>\n\t\t\t\t\t\t<view class=\"dot\"></view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"loading-text\">AIæ­£åœ¨æ€è€ƒ...</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</scroll-view>\n\t\t\n\t\t<!-- å›ºå®šåœ¨åº•éƒ¨çš„è¾“å…¥åŒºåŸŸ -->\n\t\t<view class=\"input-container-fixed\">\n\t\t\t<!-- åŠŸèƒ½æŒ‰é’®åŒºåŸŸ -->\n\t\t\t<view class=\"function-buttons\">\n\t\t\t\t<button class=\"clear-btn\" @click=\"clearChatHistory\">\n\t\t\t\t\tğŸ—‘ï¸ æ¸…ç©ºè®°å½•\n\t\t\t\t</button>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- å½•éŸ³çŠ¶æ€é®ç½© -->\n\t\t\t<view class=\"recording-overlay\" v-if=\"isRecording\">\n\t\t\t\t<view class=\"recording-content\">\n\t\t\t\t\t<view class=\"voice-animation\">\n\t\t\t\t\t\t<view class=\"voice-icon\">ğŸ¤</view>\n\t\t\t\t\t\t<view class=\"wave-container\">\n\t\t\t\t\t\t\t<view class=\"wave wave1\"></view>\n\t\t\t\t\t\t\t<view class=\"wave wave2\"></view>\n\t\t\t\t\t\t\t<view class=\"wave wave3\"></view>\n\t\t\t\t\t\t\t<view class=\"wave wave4\"></view>\n\t\t\t\t\t\t\t<view class=\"wave wave5\"></view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"recording-text\">æ¾å¼€ ç»“æŸ</text>\n\t\t\t\t\t<text class=\"recording-hint\">æ­£åœ¨å½•éŸ³...</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"input-row\">\n\t\t\t\t<!-- è¯­éŸ³æŒ‰é’® -->\n\t\t\t\t<button class=\"voice-toggle-btn\" @click=\"toggleInputMode\" v-if=\"!isVoiceMode\">\n\t\t\t\t\tğŸ¤\n\t\t\t\t</button>\n\t\t\t\t\n\t\t\t\t<!-- é”®ç›˜æŒ‰é’® -->\n\t\t\t\t<button class=\"keyboard-toggle-btn\" @click=\"toggleInputMode\" v-if=\"isVoiceMode\">\n\t\t\t\t\tâŒ¨ï¸\n\t\t\t\t</button>\n\t\t\t\t\n\t\t\t\t<!-- æ–‡æœ¬è¾“å…¥æ¨¡å¼ -->\n\t\t\t\t<template v-if=\"!isVoiceMode\">\n\t\t\t\t\t<input \n\t\t\t\t\t\tclass=\"chat-input\" \n\t\t\t\t\t\tv-model=\"inputText\" \n\t\t\t\t\t\tplaceholder=\"è¾“å…¥æ¶ˆæ¯...\" \n\t\t\t\t\t\t@confirm=\"sendMessage\"\n\t\t\t\t\t\t:disabled=\"isLoading\"\n\t\t\t\t\t\tconfirm-type=\"send\"\n\t\t\t\t\t/>\n\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"send-btn\" \n\t\t\t\t\t\t@click=\"sendMessage\"\n\t\t\t\t\t\t:disabled=\"isLoading || !inputText.trim()\">\n\t\t\t\t\t\t<text class=\"send-text\">{{ isLoading ? 'å‘é€ä¸­' : 'å‘é€' }}</text>\n\t\t\t\t\t</button>\n\t\t\t\t</template>\n\t\t\t\t\n\t\t\t\t<!-- è¯­éŸ³è¾“å…¥æ¨¡å¼ -->\n\t\t\t\t<template v-if=\"isVoiceMode\">\n\t\t\t\t\t<button \n\t\t\t\t\t\tclass=\"voice-btn\" \n\t\t\t\t\t\t@touchstart=\"startVoiceRecording\"\n\t\t\t\t\t\t@touchend=\"stopVoiceRecording\"\n\t\t\t\t\t\t@touchcancel=\"stopVoiceRecording\"\n\t\t\t\t\t\t:disabled=\"isLoading\"\n\t\t\t\t\t\t:class=\"{ 'recording': isRecording }\">\n\t\t\t\t\t\t<text class=\"voice-text\">{{ isRecording ? 'æ¾å¼€ ç»“æŸ' : 'æŒ‰ä½ è¯´è¯' }}</text>\n\t\t\t\t\t</button>\n\t\t\t\t</template>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tmessages: [],\n\t\t\t\tinputText: '',\n\t\t\t\tisLoading: false,\n\t\t\t\tscrollTop: 0,\n\t\t\t\taiConfig: null,\n\t\t\t\t// è¯­éŸ³è¯†åˆ«ç›¸å…³\n\t\t\t\tisRecording: false,\n\t\t\t\tisVoiceMode: false, // è¯­éŸ³è¾“å…¥æ¨¡å¼åˆ‡æ¢\n\t\t\t\tvoiceConfig: null,\n\t\t\t\trecordManager: null,\n\t\t\t\ttempAudioPath: ''\n\t\t\t}\n\t\t},\n\t\t\n\t\tonLoad() {\n\t\t\tthis.loadAIConfig()\n\t\t\tthis.loadVoiceConfig()\n\t\t\tthis.loadChatHistory()\n\t\t},\n\t\t\n\t\tmethods: {\n\t\t\t// ç”³è¯·éº¦å…‹é£æƒé™\n\t\t\tasync requestMicrophonePermission() {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t// æ£€æŸ¥æ˜¯å¦æ”¯æŒæƒé™ç”³è¯·API\n\t\t\t\t\tif (uni.authorize) {\n\t\t\t\t\t\tuni.authorize({\n\t\t\t\t\t\t\tscope: 'scope.record',\n\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\tconsole.log('éº¦å…‹é£æƒé™è·å–æˆåŠŸ')\n\t\t\t\t\t\t\t\tresolve()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfail: (error) => {\n\t\t\t\t\t\t\t\tconsole.log('éº¦å…‹é£æƒé™è·å–å¤±è´¥:', error)\n\t\t\t\t\t\t\t\t// æƒé™è¢«æ‹’ç»ï¼Œå¼•å¯¼ç”¨æˆ·æ‰‹åŠ¨å¼€å¯\n\t\t\t\t\t\t\t\treject(new Error('permission_denied'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t} else if (uni.getSetting && uni.authorize) {\n\t\t\t\t\t\t// å…ˆæ£€æŸ¥å½“å‰æƒé™çŠ¶æ€\n\t\t\t\t\t\tuni.getSetting({\n\t\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\t\tif (res.authSetting['scope.record']) {\n\t\t\t\t\t\t\t\t\t// å·²æœ‰æƒé™\n\t\t\t\t\t\t\t\t\tresolve()\n\t\t\t\t\t\t\t\t} else if (res.authSetting['scope.record'] === false) {\n\t\t\t\t\t\t\t\t\t// æƒé™è¢«æ‹’ç»ï¼Œéœ€è¦å¼•å¯¼ç”¨æˆ·æ‰‹åŠ¨å¼€å¯\n\t\t\t\t\t\t\t\t\treject(new Error('permission_denied'))\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// å°šæœªæˆæƒï¼Œä¸»åŠ¨ç”³è¯·\n\t\t\t\t\t\t\t\t\tuni.authorize({\n\t\t\t\t\t\t\t\t\t\tscope: 'scope.record',\n\t\t\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\t\t\tresolve()\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tfail: () => {\n\t\t\t\t\t\t\t\t\t\t\treject(new Error('permission_denied'))\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfail: () => {\n\t\t\t\t\t\t\t\t// é™çº§å¤„ç†ï¼Œç›´æ¥å°è¯•ç”³è¯·æƒé™\n\t\t\t\t\t\t\t\tuni.authorize({\n\t\t\t\t\t\t\t\t\tscope: 'scope.record',\n\t\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\t\tresolve()\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tfail: () => {\n\t\t\t\t\t\t\t\t\t\treject(new Error('permission_denied'))\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// åœ¨ä¸æ”¯æŒæƒé™APIçš„ç¯å¢ƒä¸­ï¼Œç›´æ¥é€šè¿‡\n\t\t\t\t\t\tconsole.log('å½“å‰ç¯å¢ƒä¸æ”¯æŒæƒé™æ£€æŸ¥ï¼Œç›´æ¥é€šè¿‡')\n\t\t\t\t\t\tresolve()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// åˆ‡æ¢è¾“å…¥æ¨¡å¼\n\t\t\ttoggleInputMode() {\n\t\t\t\tthis.isVoiceMode = !this.isVoiceMode\n\t\t\t},\n\t\t\t\n\t\t\t// åŠ è½½è¯­éŸ³è¯†åˆ«é…ç½®\n\t\t\tloadVoiceConfig() {\n\t\t\t\tthis.voiceConfig = uni.getStorageSync('voiceConfig')\n\t\t\t},\n\t\t\t\n\t\t\t// å¼€å§‹è¯­éŸ³å½•åˆ¶\n\t\t\tasync startVoiceRecording() {\n\t\t\t\t// é¦–å…ˆç”³è¯·éº¦å…‹é£æƒé™\n\t\t\t\ttry {\n\t\t\t\t\tawait this.requestMicrophonePermission()\n\t\t\t\t} catch (error) {\n\t\t\t\t\tlet title = 'éœ€è¦éº¦å…‹é£æƒé™'\n\t\t\t\t\tlet content = 'ä½¿ç”¨è¯­éŸ³è®°è´¦åŠŸèƒ½éœ€è¦éº¦å…‹é£æƒé™'\n\t\t\t\t\t\n\t\t\t\t\tif (error.message === 'permission_denied') {\n\t\t\t\t\t\ttitle = 'éº¦å…‹é£æƒé™è¢«æ‹’ç»'\n\t\t\t\t\t\tcontent = 'æ£€æµ‹åˆ°éº¦å…‹é£æƒé™è¢«æ‹’ç»ï¼Œè¯·æ‰‹åŠ¨å¼€å¯æƒé™åé‡è¯•'\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\tcontent: content,\n\t\t\t\t\t\tconfirmText: 'äº†è§£',\n\t\t\t\t\t\tshowCancel: false,\n\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t// æ˜¾ç¤ºæ“ä½œæŒ‡å¼•\n\t\t\t\t\t\t\tconst systemInfo = uni.getSystemInfoSync()\n\t\t\t\t\t\t\tlet guide = ''\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (systemInfo.platform === 'ios') {\n\t\t\t\t\t\t\t\tguide = 'iOSç”¨æˆ·ï¼šè®¾ç½® â†’ éšç§ä¸å®‰å…¨ â†’ éº¦å…‹é£ â†’ æ‰¾åˆ°æœ¬åº”ç”¨å¹¶å¼€å¯'\n\t\t\t\t\t\t\t} else if (systemInfo.platform === 'android') {\n\t\t\t\t\t\t\t\tguide = 'Androidç”¨æˆ·ï¼šè®¾ç½® â†’ åº”ç”¨ç®¡ç† â†’ æœ¬åº”ç”¨ â†’ æƒé™ç®¡ç† â†’ å¼€å¯éº¦å…‹é£æƒé™'\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tguide = 'è¯·åœ¨ç³»ç»Ÿè®¾ç½®ä¸­ä¸ºæœ¬åº”ç”¨å¼€å¯éº¦å…‹é£æƒé™'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: guide,\n\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\tduration: 4000\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tthis.loadVoiceConfig();\n\t\t\t\tif (!this.voiceConfig) {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: 'éœ€è¦é…ç½®è¯­éŸ³è¯†åˆ«',\n\t\t\t\t\t\tcontent: 'è¯·å…ˆåœ¨\"æˆ‘çš„\"é¡µé¢é…ç½®è¯­éŸ³è¯†åˆ«æœåŠ¡ï¼Œæ‰èƒ½ä½¿ç”¨è¯­éŸ³è®°è´¦åŠŸèƒ½',\n\t\t\t\t\t\tconfirmText: 'å»é…ç½®',\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\t\t\turl: '/pages/voice-config/voice-config'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!this.voiceConfig.appId || !this.voiceConfig.accessKey) {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: 'é…ç½®ä¸å®Œæ•´',\n\t\t\t\t\t\tcontent: 'éœ€è¦é…ç½®App IDå’ŒAccess Keyæ‰èƒ½ä½¿ç”¨è¯­éŸ³è¯†åˆ«åŠŸèƒ½',\n\t\t\t\t\t\tconfirmText: 'å»é…ç½®',\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\t\t\turl: '/pages/voice-config/voice-config'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!uni.getRecorderManager) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'å½“å‰ç¯å¢ƒä¸æ”¯æŒå½•éŸ³åŠŸèƒ½',\n\t\t\t\t\t\ticon: 'error'\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.isRecording = true\n\t\t\t\tthis.recordManager = uni.getRecorderManager()\n\t\t\t\t\n\t\t\t\tthis.recordManager.onStart(() => {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'å¼€å§‹å½•éŸ³...',\n\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\tduration: 1000\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tthis.recordManager.onStop((res) => {\n\t\t\t\t\tthis.tempAudioPath = res.tempFilePath\n\t\t\t\t\tif (!res.tempFilePath) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'å½•éŸ³æ–‡ä»¶æ— æ•ˆï¼Œè¯·é‡è¯•',\n\t\t\t\t\t\t\ticon: 'error'\n\t\t\t\t\t\t})\n\t\t\t\t\t\tthis.isRecording = false\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tthis.processVoiceRecording()\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tthis.recordManager.onError((error) => {\n\t\t\t\t\tthis.isRecording = false\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'å½•éŸ³å¤±è´¥ï¼Œè¯·é‡è¯•',\n\t\t\t\t\t\ticon: 'error'\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tthis.recordManager.start({\n\t\t\t\t\tduration: 60000,\n\t\t\t\t\tsampleRate: 16000,\n\t\t\t\t\tnumberOfChannels: 1,\n\t\t\t\t\tencodeBitRate: 96000,\n\t\t\t\t\tformat: 'wav'\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// åœæ­¢è¯­éŸ³å½•åˆ¶\n\t\t\tstopVoiceRecording() {\n\t\t\t\tif (!this.isRecording) return\n\t\t\t\tthis.isRecording = false\n\t\t\t\tif (this.recordManager) {\n\t\t\t\t\tthis.recordManager.stop()\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// å¤„ç†è¯­éŸ³å½•åˆ¶ç»“æœ\n\t\t\tasync processVoiceRecording() {\n\t\t\t\tif (!this.tempAudioPath) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'å½•éŸ³æ–‡ä»¶æ— æ•ˆ',\n\t\t\t\t\t\ticon: 'error'\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: 'æ­£åœ¨è¯†åˆ«è¯­éŸ³...'\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tconst recognizedText = await this.callFlashAPI()\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\n\t\t\t\t\tif (recognizedText) {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'è¯­éŸ³è¯†åˆ«æˆåŠŸ',\n\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t})\n\t\t\t\t\t\tawait this.sendMessage(null,recognizedText)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: 'æœªè¯†åˆ«åˆ°æœ‰æ•ˆå†…å®¹',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tuni.hideLoading()\n\t\t\t\t\t\n\t\t\t\t\tlet errorMessage = 'è¯­éŸ³è¯†åˆ«å¤±è´¥ï¼Œè¯·é‡è¯•'\n\t\t\t\t\tlet showConfigModal = false\n\t\t\t\t\t\n\t\t\t\t\tif (error.message.includes('grant not found') || error.message.includes('éªŒè¯å¤±è´¥')) {\n\t\t\t\t\t\terrorMessage = 'è¯­éŸ³è¯†åˆ«é…ç½®é”™è¯¯ï¼Œè¯·å‰å¾€è®¾ç½®é¡µé¢é‡æ–°é…ç½®'\n\t\t\t\t\t\tshowConfigModal = true\n\t\t\t\t\t} else if (error.message.includes('ä¸æ”¯æŒ') || error.message.includes('æ— æ³•è¯»å–')) {\n\t\t\t\t\t\terrorMessage = 'å½“å‰ç¯å¢ƒä¸æ”¯æŒè¯­éŸ³åŠŸèƒ½ï¼Œå»ºè®®ä½¿ç”¨æ–‡å­—è¾“å…¥'\n\t\t\t\t\t} else if (error.message.includes('ç½‘ç»œ') || error.message.includes('timeout')) {\n\t\t\t\t\t\terrorMessage = 'ç½‘ç»œè¿æ¥é—®é¢˜ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•'\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (showConfigModal) {\n\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\ttitle: 'é…ç½®é”™è¯¯',\n\t\t\t\t\t\t\tcontent: errorMessage + '\\n\\nç‚¹å‡»ç¡®è®¤å‰å¾€é…ç½®é¡µé¢',\n\t\t\t\t\t\t\tconfirmText: 'å»é…ç½®',\n\t\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\t\t\t\turl: '/pages/voice-config/voice-config'\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: errorMessage,\n\t\t\t\t\t\t\ticon: 'error'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// ä½¿ç”¨Flash APIè¿›è¡Œè¯­éŸ³è¯†åˆ«\n\t\t\tasync callFlashAPI() {\n\t\t\t\tconst recognizeUrl = \"https://openspeech.bytedance.com/api/v3/auc/bigmodel/recognize/flash\"\n\t\t\t\tconst audioBase64 = await this.getAudioBase64()\n\t\t\t\t\n\t\t\t\tconst headers = {\n\t\t\t\t\t\"X-Api-App-Key\": this.voiceConfig.appId,\n\t\t\t\t\t\"X-Api-Access-Key\": this.voiceConfig.accessKey,\n\t\t\t\t\t\"X-Api-Resource-Id\": \"volc.bigasr.auc_turbo\",\n\t\t\t\t\t\"X-Api-Request-Id\": this.generateUUID(),\n\t\t\t\t\t\"X-Api-Sequence\": \"-1\",\n\t\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst requestData = {\n\t\t\t\t\tuser: {\n\t\t\t\t\t\tuid: this.voiceConfig.appId\n\t\t\t\t\t},\n\t\t\t\t\taudio: {\n\t\t\t\t\t\tdata: audioBase64\n\t\t\t\t\t},\n\t\t\t\t\trequest: {\n\t\t\t\t\t\tmodel_name: this.voiceConfig.modelName || \"bigmodel\",\n\t\t\t\t\t\tenable_itn: this.voiceConfig.enableItn !== false,\n\t\t\t\t\t\tenable_punc: this.voiceConfig.enablePunc !== false,\n\t\t\t\t\t\tenable_ddc: true,\n\t\t\t\t\t\tenable_speaker_info: this.voiceConfig.enableSpeakerInfo || false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst response = await uni.request({\n\t\t\t\t\turl: recognizeUrl,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theader: headers,\n\t\t\t\t\tdata: requestData,\n\t\t\t\t\ttimeout: 30000\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tif (response.statusCode === 200) {\n\t\t\t\t\tconst statusCode = response.header['X-Api-Status-Code']\n\t\t\t\t\tif (statusCode === '20000000') {\n\t\t\t\t\t\tconst result = response.data\n\t\t\t\t\t\tlet recognizedText = ''\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (result && result.result && result.result.text) {\n\t\t\t\t\t\t\trecognizedText = result.result.text\n\t\t\t\t\t\t} else if (result && result.data && result.data.result && result.data.result.text) {\n\t\t\t\t\t\t\trecognizedText = result.data.result.text\n\t\t\t\t\t\t} else if (result && result.utterances && result.utterances.length > 0) {\n\t\t\t\t\t\t\trecognizedText = result.utterances.map(item => item.text).join('')\n\t\t\t\t\t\t} else if (result && result.text) {\n\t\t\t\t\t\t\trecognizedText = result.text\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\treturn recognizedText.trim() || null\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error(`è¯­éŸ³è¯†åˆ«å¤±è´¥: ${response.header['X-Api-Message'] || 'æœªçŸ¥é”™è¯¯'}`)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(`APIè°ƒç”¨å¤±è´¥: HTTP ${response.statusCode}`)\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// è·å–å½•éŸ³æ–‡ä»¶çš„Base64ç¼–ç \n\t\t\tasync getAudioBase64() {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tif (uni.getFileSystemManager) {\n\t\t\t\t\t\tuni.getFileSystemManager().readFile({\n\t\t\t\t\t\t\tfilePath: this.tempAudioPath,\n\t\t\t\t\t\t\tencoding: 'base64',\n\t\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\t\tresolve(res.data)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfail: (error) => {\n\t\t\t\t\t\t\t\tthis.getAudioBase64Fallback().then(resolve).catch(reject)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.getAudioBase64Fallback().then(resolve).catch(reject)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// å¤‡ç”¨æ–¹æ¡ˆï¼šä½¿ç”¨ plus.io è¯»å–æ–‡ä»¶\n\t\t\tasync getAudioBase64Fallback() {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tif (typeof plus !== 'undefined' && plus.io) {\n\t\t\t\t\t\tplus.io.resolveLocalFileSystemURL(this.tempAudioPath, (entry) => {\n\t\t\t\t\t\t\tentry.file((file) => {\n\t\t\t\t\t\t\t\tconst reader = new plus.io.FileReader()\n\t\t\t\t\t\t\t\treader.onloadend = (evt) => {\n\t\t\t\t\t\t\t\t\tif (evt.target.result) {\n\t\t\t\t\t\t\t\t\t\tconst base64Data = evt.target.result.split(',')[1] || evt.target.result\n\t\t\t\t\t\t\t\t\t\tresolve(base64Data)\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treject(new Error('æ–‡ä»¶è¯»å–ç»“æœä¸ºç©º'))\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treader.onerror = () => {\n\t\t\t\t\t\t\t\t\treject(new Error('FileReaderè¯»å–å¤±è´¥'))\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treader.readAsDataURL(file)\n\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\treject(new Error('è·å–æ–‡ä»¶å¯¹è±¡å¤±è´¥'))\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\treject(new Error('è§£ææ–‡ä»¶è·¯å¾„å¤±è´¥'))\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(new Error('å½“å‰ç¯å¢ƒæ— æ³•è¯»å–å½•éŸ³æ–‡ä»¶ï¼Œå»ºè®®ä½¿ç”¨æ–‡å­—è¾“å…¥'))\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// ç”ŸæˆUUID\n\t\t\tgenerateUUID() {\n\t\t\t\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n\t\t\t\t\tconst r = Math.random() * 16 | 0\n\t\t\t\t\tconst v = c === 'x' ? r : (r & 0x3 | 0x8)\n\t\t\t\t\treturn v.toString(16)\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// åŠ è½½AIé…ç½®\n\t\t\tloadAIConfig() {\n\t\t\t\tthis.aiConfig = uni.getStorageSync('aiConfig')\n\t\t\t\tif (!this.aiConfig || !this.aiConfig.apiUrl || !this.aiConfig.apiKey) {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: 'éœ€è¦é…ç½®AI',\n\t\t\t\t\t\tcontent: 'è¯·å…ˆåœ¨\"æˆ‘çš„\"é¡µé¢é…ç½®æ™ºèƒ½ä½“ï¼Œæ‰èƒ½ä½¿ç”¨èŠå¤©è®°è´¦åŠŸèƒ½',\n\t\t\t\t\t\tconfirmText: 'å»é…ç½®',\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\t\t\turl: '/pages/ai-config/ai-config'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tuni.navigateBack()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// åŠ è½½èŠå¤©å†å²\n\t\t\tloadChatHistory() {\n\t\t\t\tconst history = uni.getStorageSync('chatHistory') || []\n\t\t\t\tthis.messages = history\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.scrollToBottom()\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// ä¿å­˜èŠå¤©å†å²\n\t\t\tsaveChatHistory() {\n\t\t\t\t// åªä¿å­˜æœ€è¿‘50æ¡æ¶ˆæ¯\n\t\t\t\tconst historyToSave = this.messages.slice(-50)\n\t\t\t\tuni.setStorageSync('chatHistory', historyToSave)\n\t\t\t},\n\t\t\t\n\t\t\t// å¿«æ·è¾“å…¥\n\t\t\tquickInput(text) {\n\t\t\t\tthis.inputText = text\n\t\t\t\tthis.sendMessage()\n\t\t\t},\n\t\t\t\n\t\t\t// æ¸…ç©ºèŠå¤©è®°å½•\n\t\t\tclearChatHistory() {\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: 'æ¸…ç©ºèŠå¤©è®°å½•',\n\t\t\t\t\tcontent: 'ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰èŠå¤©è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚',\n\t\t\t\t\tconfirmText: 'ç¡®å®šæ¸…ç©º',\n\t\t\t\t\tcancelText: 'å–æ¶ˆ',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\tthis.messages = []\n\t\t\t\t\t\t\tuni.removeStorageSync('chatHistory')\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: 'èŠå¤©è®°å½•å·²æ¸…ç©º',\n\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// å‘é€æ¶ˆæ¯\n\t\t\tasync sendMessage(dom,messageText = null) {\n\t\t\t\tconst message = (messageText || this.inputText).trim()\n\t\t\t\tif (!message || this.isLoading) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.addMessage('user', message)\n\t\t\t\t\n\t\t\t\tif (!messageText) {\n\t\t\t\t\tthis.inputText = ''\n\t\t\t\t}\n\t\t\t\tthis.loadAIConfig()\n\t\t\t\tif (!this.aiConfig) {\n\t\t\t\t\tthis.addMessage('assistant', 'æŠ±æ­‰ï¼ŒAIé…ç½®æœªæ‰¾åˆ°ï¼Œè¯·åœ¨è®¾ç½®ä¸­é‡æ–°é…ç½®')\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.isLoading = true\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await this.callAI(message)\n\t\t\t\t\tthis.handleAIResponse(response, message)\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis.addMessage('assistant', 'æŠ±æ­‰ï¼ŒAIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åå†è¯•æˆ–æ£€æŸ¥ç½‘ç»œè¿æ¥')\n\t\t\t\t} finally {\n\t\t\t\t\tthis.isLoading = false\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// è°ƒç”¨AIæ¥å£\n\t\t\tasync callAI(userMessage) {\n\t\t\t\t// è·å–å½“å‰å¯ç”¨çš„åˆ†ç±»ä¿¡æ¯\n\t\t\t\tconst expenseCategories = uni.getStorageSync('expenseCategories') || []\n\t\t\t\tconst incomeCategories = uni.getStorageSync('incomeCategories') || []\n\t\t\t\t\n\t\t\t\t// æ„å»ºåˆ†ç±»ä¿¡æ¯æ–‡æœ¬\n\t\t\t\tconst expenseNames = expenseCategories.map(cat => cat.name).join('ã€')\n\t\t\t\tconst incomeNames = incomeCategories.map(cat => cat.name).join('ã€')\n\t\t\t\t\n\t\t\t\tlet categoryInfo = ''\n\t\t\t\tif (expenseNames || incomeNames) {\n\t\t\t\t\tcategoryInfo = '\\n\\nå½“å‰å¯ç”¨åˆ†ç±»ï¼š'\n\t\t\t\t\tif (expenseNames) {\n\t\t\t\t\t\tcategoryInfo += `\\næ”¯å‡ºç±»åˆ«ï¼š${expenseNames}`\n\t\t\t\t\t}\n\t\t\t\t\tif (incomeNames) {\n\t\t\t\t\t\tcategoryInfo += `\\næ”¶å…¥ç±»åˆ«ï¼š${incomeNames}`\n\t\t\t\t\t}\n\t\t\t\t\tcategoryInfo += '\\n\\nè¯·ä¼˜å…ˆä»ä¸Šè¿°åˆ†ç±»ä¸­é€‰æ‹©æœ€åˆé€‚çš„ï¼Œé¿å…åˆ›å»ºé‡å¤æˆ–ç›¸ä¼¼çš„åˆ†ç±»ã€‚'\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst systemPrompt = (this.aiConfig.systemPrompt || 'ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½è®°è´¦åŠ©æ‰‹') + categoryInfo\n\t\t\t\t\n\t\t\t\tconst messages = [\n\t\t\t\t\t{\n\t\t\t\t\t\trole: 'system',\n\t\t\t\t\t\tcontent: systemPrompt\n\t\t\t\t\t},\n\t\t\t\t\t// åŒ…å«æœ€è¿‘çš„å¯¹è¯å†å²ï¼ˆæœ€å¤š10æ¡ï¼‰\n\t\t\t\t\t...this.messages.slice(-10).map(msg => ({\n\t\t\t\t\t\trole: msg.role,\n\t\t\t\t\t\tcontent: msg.content\n\t\t\t\t\t})),\n\t\t\t\t\t{\n\t\t\t\t\t\trole: 'user',\n\t\t\t\t\t\tcontent: userMessage\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t\t\n\t\t\t\tconst requestData = {\n\t\t\t\t\tmodel: this.aiConfig.modelName || 'gpt-3.5-turbo',\n\t\t\t\t\tmessages: messages,\n\t\t\t\t\tmax_tokens: 500,\n\t\t\t\t\ttemperature: 0.7\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst response = await uni.request({\n\t\t\t\t\turl: this.aiConfig.apiUrl,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theader: {\n\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t'Authorization': `Bearer ${this.aiConfig.apiKey}`\n\t\t\t\t\t},\n\t\t\t\t\tdata: requestData,\n\t\t\t\t\ttimeout: 30000\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tif (response.statusCode !== 200) {\n\t\t\t\t\tthrow new Error(`HTTP ${response.statusCode}: ${response.data?.error?.message || 'è¯·æ±‚å¤±è´¥'}`)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn response.data\n\t\t\t},\n\t\t\t\n\t\t\t// å¤„ç†AIå“åº”\n\t\t\thandleAIResponse(response, userMessage) {\n\t\t\t\tconst aiReply = response.choices?.[0]?.message?.content || 'æŠ±æ­‰ï¼Œæˆ‘æ²¡æœ‰ç†è§£ä½ çš„æ„æ€'\n\t\t\t\t\n\t\t\t\t// å°è¯•è§£æè®°è´¦ä¿¡æ¯ï¼ˆæ”¯æŒå•ç¬”æˆ–å¤šç¬”ï¼‰\n\t\t\t\tconst recordsData = this.parseRecordsData(aiReply)\n\t\t\t\t\n\t\t\t\tif (recordsData && recordsData.length > 0) {\n\t\t\t\t\t// åŒ…å«è®°è´¦ä¿¡æ¯çš„å›å¤ - æ¸…ç†æ‰JSONä»£ç å—å’Œå¯¹è±¡\n\t\t\t\t\tlet replyText = aiReply\n\t\t\t\t\t\t.replace(/```(?:json)?\\s*\\{[\\s\\S]*?\\}\\s*```/g, '') // ç§»é™¤JSONä»£ç å—\n\t\t\t\t\t\t.replace(/```(?:json)?\\s*\\[[\\s\\S]*?\\]\\s*```/g, '') // ç§»é™¤JSONæ•°ç»„ä»£ç å—\n\t\t\t\t\t\t.replace(/\\{[\\s\\S]*?\"type\"\\s*:\\s*\"(expense|income)\"[\\s\\S]*?\\}/g, '') // ç§»é™¤JSONå¯¹è±¡\n\t\t\t\t\t\t.replace(/\\n\\s*\\n/g, '\\n') // æ¸…ç†å¤šä½™çš„ç©ºè¡Œ\n\t\t\t\t\t\t.trim()\n\t\t\t\t\t\n\t\t\t\t\t// å¦‚æœæ¸…ç†åæ²¡æœ‰æ–‡æœ¬ï¼Œä½¿ç”¨é»˜è®¤æ–‡æœ¬\n\t\t\t\t\tif (!replyText) {\n\t\t\t\t\t\treplyText = `æˆ‘å¸®ä½ è¯†åˆ«äº†${recordsData.length}ç¬”è®°å½•ï¼š`\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.addMessage('assistant', replyText, recordsData)\n\t\t\t\t} else {\n\t\t\t\t\t// æ™®é€šå¯¹è¯å›å¤\n\t\t\t\t\tthis.addMessage('assistant', aiReply)\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// è§£æè®°è´¦æ•°æ®ï¼ˆæ”¯æŒå•ç¬”å’Œå¤šç¬”ï¼‰\n\t\t\tparseRecordsData(text) {\n\t\t\t\ttry {\n\t\t\t\t\t// å…ˆå°è¯•æå–markdownä»£ç å—ä¸­çš„JSON\n\t\t\t\t\tconst codeBlockMatch = text.match(/```(?:json)?\\s*(\\{[\\s\\S]*?\\}|\\[[\\s\\S]*?\\])\\s*```/);\n\t\t\t\t\tif (codeBlockMatch) {\n\t\t\t\t\t\tlet jsonStr = codeBlockMatch[1].trim()\n\t\t\t\t\t\t// å¤„ç†è½¬ä¹‰å­—ç¬¦\n\t\t\t\t\t\tjsonStr = this.unescapeJsonString(jsonStr)\n\t\t\t\t\t\tconst data = JSON.parse(jsonStr)\n\t\t\t\t\t\tif (Array.isArray(data)) {\n\t\t\t\t\t\t\tconst validRecords = data.filter(item => this.validateRecordData(item))\n\t\t\t\t\t\t\treturn validRecords.length > 0 ? validRecords : null\n\t\t\t\t\t\t} else if (this.validateRecordData(data)) {\n\t\t\t\t\t\t\treturn [data]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// å°è¯•ä½¿ç”¨æ›´å¼ºçš„æ­£åˆ™è¡¨è¾¾å¼æå–JSONå¯¹è±¡\n\t\t\t\t\tconst strongObjectMatch = text.match(/\\{[\\s\\S]*?\"type\"\\s*:\\s*\"(expense|income)\"[\\s\\S]*?\\}/);\n\t\t\t\t\tif (strongObjectMatch) {\n\t\t\t\t\t\tlet objectStr = strongObjectMatch[0]\n\t\t\t\t\t\tobjectStr = this.unescapeJsonString(objectStr)\n\t\t\t\t\t\tconst data = JSON.parse(objectStr)\n\t\t\t\t\t\tif (this.validateRecordData(data)) {\n\t\t\t\t\t\t\treturn [data]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// å°è¯•åŒ¹é…æ›´å®½æ¾çš„JSONå¯¹è±¡ï¼ˆåŒ…å«æ¢è¡Œç¬¦ï¼‰\n\t\t\t\t\tconst flexibleObjectMatch = text.match(/\\{[^{}]*?\"type\"[^{}]*?\"(expense|income)\"[^{}]*?\\}/s);\n\t\t\t\t\tif (flexibleObjectMatch) {\n\t\t\t\t\t\tlet objectStr = flexibleObjectMatch[0]\n\t\t\t\t\t\tobjectStr = this.unescapeJsonString(objectStr)\n\t\t\t\t\t\tconst data = JSON.parse(objectStr)\n\t\t\t\t\t\tif (this.validateRecordData(data)) {\n\t\t\t\t\t\t\treturn [data]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// å°è¯•åŒ¹é…æ•°ç»„æ ¼å¼\n\t\t\t\t\tconst arrayMatch = text.match(/\\[[^\\]]*\\]/);\n\t\t\t\t\tif (arrayMatch) {\n\t\t\t\t\t\tlet arrayStr = arrayMatch[0]\n\t\t\t\t\t\tarrayStr = this.unescapeJsonString(arrayStr)\n\t\t\t\t\t\tconst dataArray = JSON.parse(arrayStr)\n\t\t\t\t\t\tif (Array.isArray(dataArray) && dataArray.length > 0) {\n\t\t\t\t\t\t\tconst validRecords = dataArray.filter(item => this.validateRecordData(item))\n\t\t\t\t\t\t\treturn validRecords.length > 0 ? validRecords : null\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// å°è¯•åŒ¹é…å¯¹è±¡æ ¼å¼ï¼ˆæœ€åå°è¯•ï¼Œè¾ƒå®½æ¾ï¼‰\n\t\t\t\t\tconst objectMatch = text.match(/\\{[^}]*\\}/);\n\t\t\t\t\tif (objectMatch) {\n\t\t\t\t\t\tlet objectStr = objectMatch[0]\n\t\t\t\t\t\tobjectStr = this.unescapeJsonString(objectStr)\n\t\t\t\t\t\tconst data = JSON.parse(objectStr)\n\t\t\t\t\t\tif (this.validateRecordData(data)) {\n\t\t\t\t\t\t\treturn [data]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.log('JSONè§£æå¤±è´¥:', error.message)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn null\n\t\t\t},\n\t\t\t\n\t\t\t// å¤„ç†JSONå­—ç¬¦ä¸²ä¸­çš„è½¬ä¹‰å­—ç¬¦\n\t\t\tunescapeJsonString(str) {\n\t\t\t\t// å°†å¸¸è§çš„è½¬ä¹‰å­—ç¬¦è¿˜åŸ\n\t\t\t\treturn str.replace(/\\\\\"/g, '\"')\n\t\t\t\t\t\t  .replace(/\\\\'/g, \"'\")\n\t\t\t\t\t\t  .replace(/\\\\n/g, '\\n')\n\t\t\t\t\t\t  .replace(/\\\\t/g, '\\t')\n\t\t\t\t\t\t  .replace(/\\\\r/g, '\\r')\n\t\t\t\t\t\t  .replace(/\\\\\\\\/g, '\\\\')\n\t\t\t},\n\t\t\t\n\t\t\t// éªŒè¯è®°å½•æ•°æ®\n\t\t\tvalidateRecordData(data) {\n\t\t\t\treturn data && data.type && data.amount && data.category\n\t\t\t},\n\t\t\t\n\t\t\t// æ·»åŠ æ¶ˆæ¯\n\t\t\taddMessage(role, content, recordsData = null) {\n\t\t\t\tconst message = {\n\t\t\t\t\trole,\n\t\t\t\t\tcontent,\n\t\t\t\t\ttimestamp: Date.now(),\n\t\t\t\t\trecordsData,\n\t\t\t\t\trecorded: false\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.messages.push(message)\n\t\t\t\tthis.saveChatHistory()\n\t\t\t\t\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.scrollToBottom()\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// ç¡®è®¤å¤šç¬”è®°å½•\n\t\t\tasync confirmMultipleRecords(recordsData) {\n\t\t\t\tconst results = []\n\t\t\t\tconst newCategories = []\n\t\t\t\t\n\t\t\t\tfor (const recordData of recordsData) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst result = await this.processRecord(recordData)\n\t\t\t\t\t\tresults.push(result)\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (result.isNewCategory) {\n\t\t\t\t\t\t\tnewCategories.push(result.category)\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tresults.push({ success: false, error: error.message })\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (newCategories.length > 0) {\n\t\t\t\t\tawait this.handleNewCategories(newCategories)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst messageIndex = this.messages.findIndex(msg => \n\t\t\t\t\tmsg.recordsData === recordsData\n\t\t\t\t)\n\t\t\t\tif (messageIndex !== -1) {\n\t\t\t\t\tthis.messages[messageIndex].recorded = true\n\t\t\t\t\tthis.saveChatHistory()\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst successCount = results.filter(r => r.success).length\n\t\t\t\tif (successCount === recordsData.length) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: `æˆåŠŸè®°å½•${successCount}ç¬”ï¼`,\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t})\n\t\t\t\t\tthis.addMessage('assistant', `âœ… è®°è´¦æˆåŠŸï¼å·²è®°å½•${successCount}ç¬”è´¦ç›®`)\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: `è®°å½•${successCount}/${recordsData.length}ç¬”`,\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// å¤„ç†å•æ¡è®°å½•\n\t\t\tasync processRecord(recordData) {\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\t// è§£ææ—¶é—´\n\t\t\t\t\tconst recordTime = this.parseRecordTime(recordData.time)\n\t\t\t\t\t\n\t\t\t\t\t// æ£€æŸ¥åˆ†ç±»æ˜¯å¦å­˜åœ¨\n\t\t\t\t\tconst { categoryIcon, isNewCategory, categoryId } = this.getCategoryIconWithCheck(\n\t\t\t\t\t\trecordData.category, \n\t\t\t\t\t\trecordData.type\n\t\t\t\t\t)\n\t\t\t\t\t\n\t\t\t\t\t// ç”Ÿæˆè®°å½•ID\n\t\t\t\t\tconst recordId = Date.now() + Math.random() * 1000\n\t\t\t\t\t\n\t\t\t\t\t// åˆ›å»ºè®°å½•å¯¹è±¡\n\t\t\t\t\tconst newRecord = {\n\t\t\t\t\t\tid: recordId,\n\t\t\t\t\t\ttype: recordData.type,\n\t\t\t\t\t\tamount: parseFloat(recordData.amount).toString(),\n\t\t\t\t\t\tcategoryName: recordData.category,\n\t\t\t\t\t\tcategoryId: categoryId, // æ·»åŠ åˆ†ç±»IDå…³è”\n\t\t\t\t\t\tcategoryIcon: categoryIcon,\n\t\t\t\t\t\tnote: recordData.note || '',\n\t\t\t\t\t\ttime: recordTime.toISOString()\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t// ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\n\t\t\t\t\tconst records = uni.getStorageSync('records') || []\n\t\t\t\t\trecords.push(newRecord)\n\t\t\t\t\tuni.setStorageSync('records', records)\n\t\t\t\t\t\n\t\t\t\t\tresolve({ \n\t\t\t\t\t\tsuccess: true, \n\t\t\t\t\t\trecord: newRecord,\n\t\t\t\t\t\tisNewCategory,\n\t\t\t\t\t\tcategory: isNewCategory ? {\n\t\t\t\t\t\t\tname: recordData.category,\n\t\t\t\t\t\t\ticon: categoryIcon,\n\t\t\t\t\t\t\ttype: recordData.type\n\t\t\t\t\t\t} : null\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// è§£æè®°å½•æ—¶é—´\n\t\t\tparseRecordTime(timeDescription) {\n\t\t\t\tconst now = new Date()\n\t\t\t\t\n\t\t\t\tif (!timeDescription || timeDescription === 'åˆšæ‰') {\n\t\t\t\t\treturn now\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// è§£æç›¸å¯¹æ—¶é—´\n\t\t\t\tif (timeDescription.includes('ä»Šå¤©')) {\n\t\t\t\t\tif (timeDescription.includes('æ—©ä¸Š') || timeDescription.includes('ä¸Šåˆ')) {\n\t\t\t\t\t\treturn new Date(now.getFullYear(), now.getMonth(), now.getDate(), 8, 0)\n\t\t\t\t\t} else if (timeDescription.includes('ä¸­åˆ')) {\n\t\t\t\t\t\treturn new Date(now.getFullYear(), now.getMonth(), now.getDate(), 12, 0)\n\t\t\t\t\t} else if (timeDescription.includes('ä¸‹åˆ')) {\n\t\t\t\t\t\treturn new Date(now.getFullYear(), now.getMonth(), now.getDate(), 15, 0)\n\t\t\t\t\t} else if (timeDescription.includes('æ™šä¸Š')) {\n\t\t\t\t\t\treturn new Date(now.getFullYear(), now.getMonth(), now.getDate(), 19, 0)\n\t\t\t\t\t}\n\t\t\t\t} else if (timeDescription.includes('æ˜¨å¤©')) {\n\t\t\t\t\tconst yesterday = new Date(now)\n\t\t\t\t\tyesterday.setDate(now.getDate() - 1)\n\t\t\t\t\t\n\t\t\t\t\tif (timeDescription.includes('æ—©ä¸Š') || timeDescription.includes('ä¸Šåˆ')) {\n\t\t\t\t\t\treturn new Date(yesterday.getFullYear(), yesterday.getMonth(), yesterday.getDate(), 8, 0)\n\t\t\t\t\t} else if (timeDescription.includes('ä¸­åˆ')) {\n\t\t\t\t\t\treturn new Date(yesterday.getFullYear(), yesterday.getMonth(), yesterday.getDate(), 12, 0)\n\t\t\t\t\t} else if (timeDescription.includes('ä¸‹åˆ')) {\n\t\t\t\t\t\treturn new Date(yesterday.getFullYear(), yesterday.getMonth(), yesterday.getDate(), 15, 0)\n\t\t\t\t\t} else if (timeDescription.includes('æ™šä¸Š')) {\n\t\t\t\t\t\treturn new Date(yesterday.getFullYear(), yesterday.getMonth(), yesterday.getDate(), 19, 0)\n\t\t\t\t\t}\n\t\t\t\t} else if (timeDescription.includes('å‰å¤©')) {\n\t\t\t\t\tconst dayBeforeYesterday = new Date(now)\n\t\t\t\t\tdayBeforeYesterday.setDate(now.getDate() - 2)\n\t\t\t\t\treturn new Date(dayBeforeYesterday.getFullYear(), dayBeforeYesterday.getMonth(), dayBeforeYesterday.getDate(), 12, 0)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// é»˜è®¤è¿”å›å½“å‰æ—¶é—´\n\t\t\t\treturn now\n\t\t\t},\n\t\t\t\n\t\t\t// ç¡®è®¤å•ç¬”è®°å½•ï¼ˆä»å¤šç¬”è®°å½•ä¸­ï¼‰\n\t\t\tasync confirmSingleRecord(record, recordIndex, message) {\n\t\t\t\ttry {\n\t\t\t\t\tconst { categoryIcon, isNewCategory, categoryId } = this.getCategoryIconWithCheck(\n\t\t\t\t\t\trecord.category, \n\t\t\t\t\t\trecord.type\n\t\t\t\t\t)\n\t\t\t\t\t\n\t\t\t\t\tlet finalCategoryId = categoryId\n\t\t\t\t\tif (isNewCategory) {\n\t\t\t\t\t\tconst newCategory = {\n\t\t\t\t\t\t\tname: record.category,\n\t\t\t\t\t\t\ticon: categoryIcon,\n\t\t\t\t\t\t\ttype: record.type\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst addedCategories = await this.handleNewCategories([newCategory])\n\t\t\t\t\t\tif (addedCategories && addedCategories.length > 0) {\n\t\t\t\t\t\t\tfinalCategoryId = addedCategories[0].id\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst recordTime = this.parseRecordTime(record.time)\n\t\t\t\t\tconst recordId = Date.now() + Math.random() * 1000\n\t\t\t\t\t\n\t\t\t\t\tconst newRecord = {\n\t\t\t\t\t\tid: recordId,\n\t\t\t\t\t\ttype: record.type,\n\t\t\t\t\t\tamount: parseFloat(record.amount).toString(),\n\t\t\t\t\t\tcategoryName: record.category,\n\t\t\t\t\t\tcategoryId: finalCategoryId,\n\t\t\t\t\t\tcategoryIcon: categoryIcon,\n\t\t\t\t\t\tnote: record.note || '',\n\t\t\t\t\t\ttime: recordTime.toISOString()\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst records = uni.getStorageSync('records') || []\n\t\t\t\t\trecords.push(newRecord)\n\t\t\t\t\tuni.setStorageSync('records', records)\n\t\t\t\t\t\n\t\t\t\t\tmessage.recordsData[recordIndex].recorded = true\n\t\t\t\t\t\n\t\t\t\t\tconst allRecorded = message.recordsData.every(r => r.recorded)\n\t\t\t\t\tif (allRecorded) {\n\t\t\t\t\t\tmessage.recorded = true\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.saveChatHistory()\n\t\t\t\t\t\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'è®°è´¦æˆåŠŸï¼',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t})\n\t\t\t\t\t\n\t\t\t\t\tthis.addMessage('assistant', `âœ… å·²è®°å½•${record.type === 'expense' ? 'æ”¯å‡º' : 'æ”¶å…¥'}Â¥${record.amount} (${record.category})`)\n\t\t\t\t\t\n\t\t\t\t} catch (error) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: 'è®°è´¦å¤±è´¥ï¼Œè¯·é‡è¯•',\n\t\t\t\t\t\ticon: 'error'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// è·å–åˆ†ç±»å›¾æ ‡å¹¶æ£€æŸ¥æ˜¯å¦ä¸ºæ–°åˆ†ç±»\n\t\t\tgetCategoryIconWithCheck(categoryName, type) {\n\t\t\t\tconst expenseCategories = uni.getStorageSync('expenseCategories') || []\n\t\t\t\tconst incomeCategories = uni.getStorageSync('incomeCategories') || []\n\t\t\t\t\n\t\t\t\tconst allCategories = [...expenseCategories, ...incomeCategories]\n\t\t\t\tconst existingCategory = allCategories.find(cat => cat.name === categoryName)\n\t\t\t\t\n\t\t\t\tif (existingCategory) {\n\t\t\t\t\treturn { \n\t\t\t\t\t\tcategoryIcon: existingCategory.icon, \n\t\t\t\t\t\tcategoryId: existingCategory.id,\n\t\t\t\t\t\tisNewCategory: false \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst newIcon = this.generateCategoryIcon(categoryName, type)\n\t\t\t\treturn { \n\t\t\t\t\tcategoryIcon: newIcon, \n\t\t\t\t\tcategoryId: null,\n\t\t\t\t\tisNewCategory: true \n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// ç”Ÿæˆæ–°åˆ†ç±»å›¾æ ‡\n\t\t\tgenerateCategoryIcon(categoryName, type) {\n\t\t\t\tconst iconMap = {\n\t\t\t\t\t'æ—©é¤': 'ğŸ¥', 'åˆé¤': 'ğŸ±', 'æ™šé¤': 'ğŸ½ï¸', 'å¤œå®µ': 'ğŸŒ™',\n\t\t\t\t\t'å’–å•¡': 'â˜•', 'å¥¶èŒ¶': 'ğŸ§‹', 'é¥®æ–™': 'ğŸ¥¤',\n\t\t\t\t\t'æ‰“è½¦': 'ğŸš—', 'åœ°é“': 'ğŸš‡', 'å…¬äº¤': 'ğŸšŒ', 'æ²¹è´¹': 'â›½',\n\t\t\t\t\t'é›¶é£Ÿ': 'ğŸ¿', 'æ°´æœ': 'ğŸ', 'è”¬èœ': 'ğŸ¥¬', 'è‚‰ç±»': 'ğŸ¥©',\n\t\t\t\t\t'æ´—è¡£': 'ğŸ‘•', 'ç†å‘': 'ğŸ’‡', 'ç¾å®¹': 'ğŸ’„', 'å¥èº«': 'ğŸ’ª',\n\t\t\t\t\t'å® ç‰©': 'ğŸ±', 'èŠ±å‰': 'ğŸŒ¸', 'ä¹¦ç±': 'ğŸ“š', \n\t\t\t\t\t'å…¼èŒ': 'ğŸ’¼', 'å¥–åŠ±': 'ğŸ', 'è¡¥è´´': 'ğŸ’°'\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (iconMap[categoryName]) {\n\t\t\t\t\treturn iconMap[categoryName]\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor (const [key, icon] of Object.entries(iconMap)) {\n\t\t\t\t\tif (categoryName.includes(key) || key.includes(categoryName)) {\n\t\t\t\t\t\treturn icon\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn type === 'expense' ? 'ğŸ’°' : 'ğŸ’'\n\t\t\t},\n\t\t\t\n\t\t\t// å¤„ç†æ–°åˆ†ç±»\n\t\t\tasync handleNewCategories(newCategories) {\n\t\t\t\tif (newCategories.length === 0) return null\n\t\t\t\t\n\t\t\t\tconst categoryNames = newCategories.map(cat => cat.name).join('ã€')\n\t\t\t\t\n\t\t\t\treturn new Promise((resolve) => {\n\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\ttitle: 'å‘ç°æ–°åˆ†ç±»',\n\t\t\t\t\t\tcontent: `æ£€æµ‹åˆ°æ–°çš„æ¶ˆè´¹åˆ†ç±»ï¼š${categoryNames}\\n\\næ˜¯å¦è¦æ·»åŠ åˆ°åˆ†ç±»ç®¡ç†ä¸­ï¼Ÿ`,\n\t\t\t\t\t\tconfirmText: 'æ·»åŠ ',\n\t\t\t\t\t\tcancelText: 'è·³è¿‡',\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\t\tconst addedCategories = this.addNewCategoriesToStorage(newCategories)\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: 'åˆ†ç±»å·²æ·»åŠ ',\n\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tresolve(addedCategories) // è¿”å›æ·»åŠ çš„åˆ†ç±»ä¿¡æ¯ï¼ˆåŒ…å«IDï¼‰\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresolve(null) // ç”¨æˆ·å–æ¶ˆæ·»åŠ \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t// æ·»åŠ æ–°åˆ†ç±»åˆ°å­˜å‚¨\n\t\t\taddNewCategoriesToStorage(newCategories) {\n\t\t\t\tconst expenseCategories = uni.getStorageSync('expenseCategories') || []\n\t\t\t\tconst incomeCategories = uni.getStorageSync('incomeCategories') || []\n\t\t\t\tconst addedCategories = []\n\t\t\t\t\n\t\t\t\tnewCategories.forEach((category, index) => {\n\t\t\t\t\tconst uniqueId = Date.now() + index * 1000 + Math.floor(Math.random() * 1000)\n\t\t\t\t\t\n\t\t\t\t\tconst newCategoryItem = {\n\t\t\t\t\t\tid: uniqueId,\n\t\t\t\t\t\tname: category.name,\n\t\t\t\t\t\ticon: category.icon\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (category.type === 'expense') {\n\t\t\t\t\t\texpenseCategories.push(newCategoryItem)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tincomeCategories.push(newCategoryItem)\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\taddedCategories.push({\n\t\t\t\t\t\t...category,\n\t\t\t\t\t\tid: uniqueId\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\tuni.setStorageSync('expenseCategories', expenseCategories)\n\t\t\t\tuni.setStorageSync('incomeCategories', incomeCategories)\n\t\t\t\t\n\t\t\t\treturn addedCategories\n\t\t\t},\n\t\t\t\n\t\t\t// è·å–åˆ†ç±»å›¾æ ‡\n\t\t\tgetCategoryIcon(categoryName, type) {\n\t\t\t\tconst expenseIcons = {\n\t\t\t\t\t'é¤é¥®': 'ğŸ½ï¸', 'äº¤é€š': 'ğŸš—', 'è´­ç‰©': 'ğŸ›ï¸', 'å¨±ä¹': 'ğŸ¬', 'ä½æˆ¿': 'ğŸ ',\n\t\t\t\t\t'åŒ»ç–—': 'ğŸ’Š', 'æ•™è‚²': 'ğŸ“š', 'é€šè®¯': 'ğŸ“±', 'æœè£…': 'ğŸ‘•', 'å…¶ä»–': 'ğŸ“¦'\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst incomeIcons = {\n\t\t\t\t\t'å·¥èµ„': 'ğŸ’°', 'å¥–é‡‘': 'ğŸ', 'æŠ•èµ„': 'ğŸ“ˆ', 'å…¼èŒ': 'ğŸ’¼', \n\t\t\t\t\t'çº¢åŒ…': 'ğŸ§§', 'é€€æ¬¾': 'â†©ï¸', 'å…¶ä»–': 'ğŸ’'\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (type === 'expense') {\n\t\t\t\t\treturn expenseIcons[categoryName] || 'ğŸ“¦'\n\t\t\t\t} else {\n\t\t\t\t\treturn incomeIcons[categoryName] || 'ğŸ’'\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// æ ¼å¼åŒ–æ—¶é—´\n\t\t\tformatTime(timestamp) {\n\t\t\t\tconst date = new Date(timestamp)\n\t\t\t\tconst now = new Date()\n\t\t\t\t\n\t\t\t\t// è·å–ä»Šå¤©ã€æ˜¨å¤©ã€å‰å¤©çš„æ—¥æœŸï¼ˆåªæ¯”è¾ƒå¹´æœˆæ—¥ï¼‰\n\t\t\t\tconst today = new Date(now.getFullYear(), now.getMonth(), now.getDate())\n\t\t\t\tconst yesterday = new Date(today.getTime() - 24 * 60 * 60 * 1000)\n\t\t\t\tconst dayBeforeYesterday = new Date(today.getTime() - 2 * 24 * 60 * 60 * 1000)\n\t\t\t\t\n\t\t\t\tconst messageDate = new Date(date.getFullYear(), date.getMonth(), date.getDate())\n\t\t\t\t\n\t\t\t\t// æ ¼å¼åŒ–æ—¶åˆ†\n\t\t\t\tconst hours = date.getHours().toString().padStart(2, '0')\n\t\t\t\tconst minutes = date.getMinutes().toString().padStart(2, '0')\n\t\t\t\tconst timeStr = `${hours}:${minutes}`\n\t\t\t\t\n\t\t\t\t// æ ¹æ®æ—¥æœŸåˆ¤æ–­æ˜¾ç¤ºæ ¼å¼\n\t\t\t\tif (messageDate.getTime() === today.getTime()) {\n\t\t\t\t\treturn `ä»Šå¤© ${timeStr}`\n\t\t\t\t} else if (messageDate.getTime() === yesterday.getTime()) {\n\t\t\t\t\treturn `æ˜¨å¤© ${timeStr}`\n\t\t\t\t} else if (messageDate.getTime() === dayBeforeYesterday.getTime()) {\n\t\t\t\t\treturn `å‰å¤© ${timeStr}`\n\t\t\t\t} else if (date.getFullYear() === now.getFullYear()) {\n\t\t\t\t\t// åŒå¹´ä½†ä¸æ˜¯è¿‘ä¸‰å¤©ï¼Œæ˜¾ç¤ºæœˆæ—¥\n\t\t\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0')\n\t\t\t\t\tconst day = date.getDate().toString().padStart(2, '0')\n\t\t\t\t\treturn `${month}-${day} ${timeStr}`\n\t\t\t\t} else {\n\t\t\t\t\t// ä¸åŒå¹´ï¼Œæ˜¾ç¤ºå®Œæ•´æ—¥æœŸ\n\t\t\t\t\tconst year = date.getFullYear()\n\t\t\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0')\n\t\t\t\t\tconst day = date.getDate().toString().padStart(2, '0')\n\t\t\t\t\treturn `${year}-${month}-${day} ${timeStr}`\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// æ»šåŠ¨åˆ°åº•éƒ¨\n\t\t\tscrollToBottom() {\n\t\t\t\tconst query = uni.createSelectorQuery().in(this)\n\t\t\t\tquery.select('.chat-container').boundingClientRect((rect) => {\n\t\t\t\t\tif (rect) {\n\t\t\t\t\t\tthis.scrollTop = rect.height\n\t\t\t\t\t}\n\t\t\t\t}).exec()\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\t/* å…¨å±€é˜²æ­¢æ°´å¹³æº¢å‡º */\n\t* {\n\t\tmax-width: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.container {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\theight: 100vh;\n\t\tbackground-color: #FAFAFA;\n\t\tmax-width: 100vw;\n\t\toverflow-x: hidden;\n\t}\n\t\n\t.chat-container {\n\t\tflex: 1;\n\t\tpadding: 30rpx 20rpx;\n\t\tpadding-bottom: 160rpx;\n\t\toverflow-y: auto;\n\t\toverflow-x: hidden;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.message-item {\n\t\tdisplay: flex;\n\t\tmargin-bottom: 35rpx;\n\t\tanimation: fadeIn 0.3s ease-in;\n\t\tmax-width: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t@keyframes fadeIn {\n\t\tfrom { opacity: 0; transform: translateY(20rpx); }\n\t\tto { opacity: 1; transform: translateY(0); }\n\t}\n\t\n\t.user-message {\n\t\tjustify-content: flex-end;  /* ç”¨æˆ·æ¶ˆæ¯æ•´ä½“é å³ */\n\t}\n\t\n\t.assistant-message {\n\t\tjustify-content: flex-start;  /* AIæ¶ˆæ¯æ•´ä½“é å·¦ */\n\t}\n\t\n\t.avatar {\n\t\twidth: 55rpx;\n\t\theight: 55rpx;\n\t\tborder-radius: 50%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tfont-size: 26rpx;\n\t\tflex-shrink: 0;\n\t\tbox-shadow: 0 2rpx 8rpx rgba(0,0,0,0.08);\n\t}\n\t\n\t.user-avatar {\n\t\tbackground: linear-gradient(135deg, #667eea, #764ba2);\n\t\tcolor: white;\n\t\tmargin-left: 15rpx;\n\t}\n\t\n\t.assistant-avatar {\n\t\tbackground: linear-gradient(135deg, #4ECDC4, #44A08D);\n\t\tcolor: white;\n\t\tmargin-right: 15rpx;\n\t}\n\t\n\t.message-content {\n\t\tmax-width: calc(100vw - 150rpx);\n\t\tmin-width: 100rpx;\n\t\tpadding: 18rpx 22rpx;\n\t\tborder-radius: 18rpx;\n\t\tposition: relative;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tword-wrap: break-word;\n\t\toverflow-wrap: break-word;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.user-message .message-content {\n\t\tbackground: linear-gradient(135deg, #667eea, #764ba2);\n\t\tcolor: white;\n\t\tborder-bottom-right-radius: 6rpx;\n\t\tbox-shadow: 0 3rpx 12rpx rgba(102, 126, 234, 0.25);\n\t}\n\t\n\t.assistant-message .message-content {\n\t\tbackground: white;\n\t\tcolor: #333;\n\t\tborder-bottom-left-radius: 6rpx;\n\t\tbox-shadow: 0 2rpx 12rpx rgba(0,0,0,0.06);\n\t}\n\t\n\t.message-text {\n\t\tfont-size: 28rpx;\n\t\tline-height: 1.6;\n\t\tmargin-bottom: 8rpx;\n\t\tword-wrap: break-word;\n\t\toverflow-wrap: break-word;\n\t\twhite-space: pre-wrap;\n\t\tmax-width: 100%;\n\t}\n\t\n\t.message-time {\n\t\tfont-size: 20rpx;\n\t\topacity: 0.5;\n\t\talign-self: flex-end;\n\t\tmargin-top: 8rpx;\n\t}\n\t\n\t/* ç”¨æˆ·æ¶ˆæ¯æ—¶é—´å·¦å¯¹é½ */\n\t.user-message .message-time {\n\t\talign-self: flex-start;\n\t}\n\t\n\t/* è®°å½•å¡ç‰‡æ ·å¼ */\n\t.records-action {\n\t\tmargin-top: 20rpx;\n\t\tpadding-top: 20rpx;\n\t\tborder-top: 1px solid rgba(0,0,0,0.1);\n\t}\n\t\n\t.single-record-confirm {\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t.record-card {\n\t\tbackground: #f8f9ff;\n\t\tborder-radius: 12rpx;\n\t\tpadding: 18rpx;\n\t\tmargin-bottom: 12rpx;\n\t\tmax-width: 100%;\n\t\tbox-sizing: border-box;\n\t\toverflow-wrap: break-word;\n\t\tbox-shadow: 0 1rpx 6rpx rgba(0,0,0,0.04);\n\t}\n\t\n\t.record-header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 10rpx;\n\t\tmargin-bottom: 15rpx;\n\t}\n\t\n\t.record-type-icon {\n\t\tfont-size: 32rpx;\n\t}\n\t\n\t.record-type-text {\n\t\tfont-size: 24rpx;\n\t\tcolor: #666;\n\t\tflex: 1;\n\t}\n\t\n\t.record-amount {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #333;\n\t}\n\t\n\t.record-details {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8rpx;\n\t\tmargin-bottom: 15rpx;\n\t}\n\t\n\t.record-category,\n\t.record-time,\n\t.record-note {\n\t\tfont-size: 24rpx;\n\t\tcolor: #666;\n\t\tline-height: 1.4;\n\t}\n\t\n\t.confirm-single-btn {\n\t\twidth: 100%;\n\t\tbackground: linear-gradient(135deg, #4ECDC4, #44A08D);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 20rpx;\n\t\tpadding: 12rpx 20rpx;\n\t\tfont-size: 24rpx;\n\t\tfont-weight: 500;\n\t\tbox-shadow: 0 2rpx 8rpx rgba(78, 205, 196, 0.25);\n\t}\n\t\n\t.recorded-single-status {\n\t\twidth: 100%;\n\t\ttext-align: center;\n\t\tpadding: 15rpx;\n\t}\n\t\n\t.recorded-text {\n\t\tcolor: #4ECDC4;\n\t\tfont-size: 26rpx;\n\t\tfont-weight: 600;\n\t}\n\t\n\t.loading-content {\n\t\tbackground: white !important;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 15rpx;\n\t}\n\t\n\t.loading-dots {\n\t\tdisplay: flex;\n\t\tgap: 8rpx;\n\t}\n\t\n\t.dot {\n\t\twidth: 12rpx;\n\t\theight: 12rpx;\n\t\tborder-radius: 50%;\n\t\tbackground: #4ECDC4;\n\t\tanimation: bounce 1.4s ease-in-out infinite both;\n\t}\n\t\n\t.dot:nth-child(1) { animation-delay: -0.32s; }\n\t.dot:nth-child(2) { animation-delay: -0.16s; }\n\t\n\t@keyframes bounce {\n\t\t0%, 80%, 100% { transform: scale(0); }\n\t\t40% { transform: scale(1); }\n\t}\n\t\n\t.loading-text {\n\t\tfont-size: 26rpx;\n\t\tcolor: #666;\n\t}\n\t\n\t/* å›ºå®šåœ¨åº•éƒ¨çš„è¾“å…¥åŒºåŸŸ */\n\t.input-container-fixed {\n\t\tposition: fixed;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbackground: linear-gradient(to bottom, #FAFAFA, #F5F5F5);\n\t\tpadding: 15rpx 20rpx 50rpx;\n\t\tz-index: 999;\n\t\tbox-sizing: border-box;\n\t\tmax-width: 100vw;\n\t\tbox-shadow: 0 -2rpx 15rpx rgba(0,0,0,0.05);\n\t\tborder-top: 1rpx solid rgba(0,0,0,0.05);\n\t}\n\t\n\t/* å½•éŸ³é®ç½©å±‚ */\n\t.recording-overlay {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tbackground: rgba(0, 0, 0, 0.6);\n\t\tz-index: 1000;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t\n\t.recording-content {\n\t\tbackground: rgba(0, 0, 0, 0.8);\n\t\tborder-radius: 20rpx;\n\t\tpadding: 60rpx 40rpx;\n\t\ttext-align: center;\n\t\tcolor: white;\n\t}\n\t\n\t.voice-animation {\n\t\tmargin-bottom: 30rpx;\n\t\tposition: relative;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t\n\t.voice-icon {\n\t\tfont-size: 60rpx;\n\t\tmargin-right: 20rpx;\n\t}\n\t\n\t.wave-container {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 6rpx;\n\t}\n\t\n\t.wave {\n\t\twidth: 6rpx;\n\t\tbackground: #1AAD19;\n\t\tborder-radius: 3rpx;\n\t\tanimation: wave-animation 1.2s ease-in-out infinite;\n\t}\n\t\n\t.wave1 { height: 20rpx; animation-delay: 0s; }\n\t.wave2 { height: 35rpx; animation-delay: 0.1s; }\n\t.wave3 { height: 50rpx; animation-delay: 0.2s; }\n\t.wave4 { height: 35rpx; animation-delay: 0.3s; }\n\t.wave5 { height: 20rpx; animation-delay: 0.4s; }\n\t\n\t@keyframes wave-animation {\n\t\t0%, 100% { transform: scaleY(0.3); }\n\t\t50% { transform: scaleY(1); }\n\t}\n\t\n\t.recording-text {\n\t\tfont-size: 32rpx;\n\t\tfont-weight: bold;\n\t\tmargin-bottom: 10rpx;\n\t\tdisplay: block;\n\t}\n\t\n\t.recording-hint {\n\t\tfont-size: 24rpx;\n\t\topacity: 0.8;\n\t\tdisplay: block;\n\t}\n\t\n\t.function-buttons {\n\t\tmargin-bottom: 15rpx;\n\t\tdisplay: flex;\n\t\tjustify-content: flex-end;\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.clear-btn {\n\t\tpadding: 12rpx 22rpx;\n\t\tbackground: linear-gradient(135deg, #FFF5F5, #FFEBEB);\n\t\tborder-radius: 15rpx;\n\t\tfont-size: 22rpx;\n\t\tcolor: #E74C3C;\n\t\tline-height: 1;\n\t\tborder: none;\n\t\tbox-shadow: 0 2rpx 6rpx rgba(231, 76, 60, 0.12);\n\t}\n\t\n\t.clear-btn:active {\n\t\tbackground: #FFE5E5;\n\t\ttransform: scale(0.95);\n\t}\n\t\n\t.input-row {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 15rpx;\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t/* åˆ‡æ¢æŒ‰é’® */\n\t.voice-toggle-btn,\n\t.keyboard-toggle-btn {\n\t\twidth: 68rpx;\n\t\theight: 68rpx;\n\t\tbackground: linear-gradient(135deg, #FFFFFF, #F8F9FA);\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 30rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\ttransition: all 0.2s ease;\n\t\tborder: none;\n\t\tbox-shadow: 0 3rpx 10rpx rgba(0,0,0,0.08);\n\t}\n\t\n\t.voice-toggle-btn:active,\n\t.keyboard-toggle-btn:active {\n\t\tbackground: linear-gradient(135deg, #F0F0F0, #E9ECEF);\n\t\ttransform: scale(0.95);\n\t}\n\t\n\t/* è¯­éŸ³è¾“å…¥æŒ‰é’® */\n\t.voice-btn {\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t\theight: 68rpx;\n\t\tbackground: linear-gradient(135deg, #FFFFFF, #F8F9FA);\n\t\tcolor: #333;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 28rpx;\n\t\tfont-weight: 500;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\ttransition: all 0.2s ease;\n\t\tbox-sizing: border-box;\n\t\tborder: none;\n\t\tbox-shadow: 0 3rpx 10rpx rgba(0,0,0,0.08);\n\t}\n\t\n\t.voice-btn.recording {\n\t\tbackground: linear-gradient(135deg, #6C757D, #5A6268);\n\t\tcolor: white;\n\t\tbox-shadow: 0 3rpx 12rpx rgba(108, 117, 125, 0.3);\n\t}\n\t\n\t.voice-btn:disabled {\n\t\topacity: 0.6;\n\t}\n\t\n\t.voice-text {\n\t\tfont-size: 28rpx;\n\t\tfont-weight: 500;\n\t}\n\t\n\t/* æ–‡æœ¬è¾“å…¥æ¡† */\n\t.chat-input {\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t\theight: 68rpx;\n\t\tpadding: 0 22rpx;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 28rpx;\n\t\tbackground: linear-gradient(135deg, #FFFFFF, #F8F9FA);\n\t\ttransition: all 0.2s ease;\n\t\tbox-sizing: border-box;\n\t\tborder: none;\n\t\tbox-shadow: 0 3rpx 10rpx rgba(0,0,0,0.08);\n\t}\n\t\n\t/* å‘é€æŒ‰é’® */\n\t.send-btn {\n\t\tmin-width: 110rpx;\n\t\twidth: auto;\n\t\theight: 68rpx;\n\t\tpadding: 0 28rpx;\n\t\tbackground: linear-gradient(135deg, #1AAD19, #179B16);\n\t\tcolor: white;\n\t\tborder: none;\n\t\tborder-radius: 12rpx;\n\t\tfont-size: 26rpx;\n\t\tfont-weight: 500;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\ttransition: all 0.2s ease;\n\t\tflex-shrink: 0;\n\t\tbox-shadow: 0 3rpx 12rpx rgba(26, 173, 25, 0.3);\n\t}\n\t\n\t.send-btn:disabled {\n\t\tbackground: linear-gradient(135deg, #E9ECEF, #DEE2E6);\n\t\tcolor: #ADB5BD;\n\t\tbox-shadow: 0 2rpx 6rpx rgba(0,0,0,0.06);\n\t}\n\t\n\t.send-btn:active:not(:disabled) {\n\t\tbackground: linear-gradient(135deg, #179B16, #148A13);\n\t\ttransform: scale(0.98);\n\t\tbox-shadow: 0 2rpx 8rpx rgba(26, 173, 25, 0.35);\n\t}\n\t\n\t.send-text {\n\t\tfont-size: 26rpx;\n\t\tfont-weight: 500;\n\t}\n</style>\n","import MiniProgramPage from 'D:/simple-account-v1.0.4/pages/chat/chat.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":"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"}